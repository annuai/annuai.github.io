/* ===============================================================================
 * alton.js v1.0
 * ===============================================================================
 * Copyright 2014 Paper Leaf Design
 * http://www.paper-leaf.com
 * 
 * Author: Paper Leaf
 *
 * A full featured scrolling plugin for creating
 * immersive featured sections or headers.
 *
 * Credit: 
 * is_mobile() based off these helpful posts
 * - http://stackoverflow.com/questions/3514784/what-is-the-best-way-to-detect-a-handheld-device-in-jquery
 * 
 * Getting stable scroll events was helped hugely by Huge Inc's insights
 * - http://www.hugeinc.com/ideas/perspective/scroll-jacking-on-hugeinc
 *
 * Stabilizing keypress events was helped in large part by jQuery OnePage Scroll
 * - https://github.com/peachananr/onepage-scroll
 * 
 * License: GPL v3
 * =============================================================================== */(function(e){"use strict";var t={firstClass:"header",fullSlideContainer:"full",singleSlideClass:"slide",nextElement:"div",previousClass:null,lastClass:"footer",slideNumbersContainer:"slide-numbers",bodyContainer:"pageWrapper",scrollMode:"featuredScroll",useSlideNumbers:!1,slideNumbersBorderColor:"#fff",slideNumbersColor:"#000",animationType:"slow"};e.fn.alton=function(n){function x(t){if(t==="featuredScroll"){for(S=s.length-1;S>=0;S-=1){e(s[S]).css("height",y);e(s[S]).outerHeight(y)}if(r.useSlideNumbers&&!N()){e("."+r.bodyContainer).append('<div id="'+r.slideNumbersContainer+'"></div>');e("#"+r.slideNumbersContainer).css({height:"100%",position:"fixed",top:0,right:"0px",bottom:"0px",width:"86px","z-index":999});e("."+r.bodyContainer+" #"+r.slideNumbersContainer).append("<ul></ul>");e("."+r.bodyContainer+" #"+r.slideNumbersContainer+" ul").css({transform:"translateY(-50%)","-moz-transform":"translateY(-50%)","-ms-transform":"translateY(-50%)","-o-transform":"translateY(-50%)","-webkit-transform":"translateY(-50%)",top:"50%",position:"fixed"});var n=0;while(n<p){e("."+r.bodyContainer+" #"+r.slideNumbersContainer+" ul").append('<li class="paginate"></ul>');T()?e(".paginate").css({cursor:"pointer","border-radius":"50%","list-style":"none",background:r.slideNumbersBorderColor,"border-color":r.slideNumbersBorderColor,"border-width":"2px","border-style":"solid",height:"11px",width:"11px",margin:"5px 0"}):e(".paginate").css({cursor:"pointer","border-radius":"50%","list-style":"none",background:r.slideNumbersBorderColor,"border-color":r.slideNumbersBorderColor,"border-width":"2px","border-style":"solid",height:"10px",width:"10px",margin:"5px 0"});n+=1}"getElementsByClassName"in document?d=document.getElementsByClassName("paginate"):d=document.querySelectorAll(".paginate")}}else{e("."+r.firstClass).css("height",y+10);if(!e("."+r.firstClass).hasClass("active")){e("."+r.firstClass).toggleClass("active");T()&&e(".paginate.active").css({"margin-left":"-1px","border-color":"#"+r.slideNumbersBorderColor,"border-style":"solid","border-width":"2px",height:"8px",width:"8px"})}}}function T(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return t>0||navigator.userAgent.match(/Trident.*rv\:11\./)?!0:!1}function N(){return navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|Windows Phone|Tizen|Bada)/)}function C(t,n){if(n&&e(d[e(t).parent().children().index(t)]).hasClass("active")){e(d[e(t).parent().children().index(t)]).toggleClass("active");e(d[e(t).parent().children().index(t)]).css("background",r.slideNumbersBorderColor)}else{e(d[e(t).parent().children().index(t)]).toggleClass("active");e(d[e(t).parent().children().index(t)]).css("background",r.slideNumbersColor)}}function k(t){r.useSlideNumbers&&(t?e("#"+r.slideNumbersContainer).fadeIn():e("#"+r.slideNumbersContainer).fadeOut())}function L(t){var n=document.getElementsByClassName(i);e(document).scrollTo(e(n[t]));f=n[t];e(f).prev().hasClass(i)?c=e(f).prev():c=e("."+r.firstClass);e(f).next().hasClass(i)?l=e(f).next():l=e("."+r.lastClass);C(e("#"+r.slideNumbersContainer+" li.active"),!0);C(n[t],!1)}function A(){if(e(window).scrollTop()>=l.offset().top&&e(window).scrollTop()+e(window).outerHeight()!==e(document).outerHeight()){var t;e("."+i).each(function(){t=e(this).offset().top;if(t<=e(window).scrollTop()){e(this).prev().hasClass(i)?c=e(this).prev():c=e("."+r.firstClass);f=e(this);f.next().hasClass(i)?l=e(this).next():l=e("."+r.lastClass);v=!1}});r.useSlideNumbers&&C(f,!1)}else{if(r.useSlideNumbers)if(h!==e("."+i+":last-child")[0])k(!1);else{k(!0);C(f,!1)}e(document).scrollTo(f)}}function O(e){e=e||window.event;if(e.preventDefault){e.stopPropagation();e.returnValue=!1}}function M(e){return O(e)}function _(){return window.pageYOffset||w.scrollTop}function D(t){o=e("body,html").is(":animated")||e("body").is(":animated")||e("html").is(":animated");clearTimeout(e.data(this,"scrollTimer"));e.data(this,"scrollTimer",setTimeout(function(){b=!1},35));if(t.originalEvent.detail>1&&!b||t.originalEvent.wheelDelta<-1&&!b){g+=1;e(document).moveDown();b=!0;O()}else if(t.originalEvent.detail<-1&&!b||t.originalEvent.wheelDelta>1&&!b){m+=1;e(document).moveUp();b=!0;O()}return!1}function P(t){E=_();if(t.originalEvent.detail>0||t.originalEvent.wheelDelta<0){if(!(e(l).offset().top>0&&E<e("."+r.firstClass).outerHeight()))return!0;if(e("."+r.firstClass).hasClass("active")){e("."+r.firstClass).toggleClass("active");e(document).scrollTo(l);c=f;f=l;return M(t)}if(!e("html, body").is(":animated"))return!0}else if(!e("."+r.firstClass).hasClass("active")&&e(window).scrollTop()<=e("."+r.firstClass).outerHeight()){e("."+r.firstClass).toggleClass("active");e(document).scrollTo(c);l=f;f=c}else if(!e("html, body").is(":animated"))return!0;return!1}var r=e.extend(!0,{},t,n),i=r.singleSlideClass,s,o,u=!1,a=!1,f,l=e("."+i+":first"),c=null,h=e("."+r.lastClass),p=e("."+r.fullSlideContainer).children().length,d,v=!0,m=0,g=0,y=e(window).outerHeight(),b=!1,w=window.document.documentElement,E,S;"getElementsByClassName"in document?s=document.getElementsByClassName(i):s=document.querySelectorAll("."+i);if(e("."+r.firstClass).length>0)f=e("."+r.firstClass);else{c=null;f=l;l=f.next();h=e("."+i+":last-child")[0]}if(r.scrollMode==="headerScroll"){f=e("."+r.firstClass);l=e("."+r.bodyContainer+":first")}e.fn.moveDown=function(){E=_();if(E>=0&&E<=e(f).scrollTop()&&v===!0){c=f;f=l;l=f.next();if(r.useSlideNumbers)if(h===e("."+i+":last-child")[0]){C(c,!0);C(f,!1)}else{C(f,!1);k(!0)}v=!1;e(document).scrollTo(f)}else if(!o&&l&&e(f).offset().top<E+1)if(l.hasClass(i)){c=f;f=l;l=e(f).next();if(r.useSlideNumbers){C(c,!0);C(f,!1)}e(document).scrollTo(f)}else if(h!==e("."+i+":last-child")[0]){c=e("."+i+":last-child")[0];f=h;l=null;if(e(window).scrollTop()+y+10>=e(document).outerHeight()-e(h).outerHeight()&&r.useSlideNumbers){C(c,!1);k(!1)}e(document).scrollTo(f)}};e.fn.moveUp=function(){E=_();if(e("."+r.fullSlideContainer).offset().top+1>E&&c&&E>0){if(e(f).offset().top>=E){f=e("."+r.firstClass);c=null;l=e("."+i);if(r.useSlideNumbers){k(!1);C(l,!1)}v=!0}else{f=c;c=null;l=e("."+i);if(r.useSlideNumbers){C(f,!0);C(c,!0)}}e(document).scrollTo(f)}else if(!o&&e("."+r.fullSlideContainer).offset().top<E){f=c;c=e(f).prev();l=e(f).next();if(r.useSlideNumbers){C(f,!1);C(l,!0);k(!0)}e(document).scrollTo(f)}a=!0;u=!1};e.fn.scrollTo=function(t){t!==h?e("body,html").stop(!0,!0).animate({scrollTop:e(t).offset().top},{duration:375}):e("body,html").stop(!0,!0).animate({scrollTop:e(document).outerHeight()-y},{duration:375})};e(document).ready(function(){x(r.scrollMode);r.scrollMode==="featuredScroll"&&!N()&&A();if(r.scrollMode==="featuredScroll"&&!N()){e("#"+r.slideNumbersContainer+" li").on("click",function(){L(e(this).parent().children().index(this))});e(document).keydown(function(t){switch(t.which){case 40:e(document).moveDown(t);t.preventDefault();break;case 32:e(document).moveDown(t);t.preventDefault();break;case 33:e(document).moveDown(t);t.preventDefault();break;case 34:e(document).moveUp(t);t.preventDefault();break;case 38:e(document).moveUp(t);t.preventDefault();break;case 50:e(document).scrollTo("."+r.firstClass);t.preventDefault();break;case 49:e(document).scrollTo(h);t.preventDefault()}})}if(!N()){r.scrollMode==="featuredScroll"?e(document).on({"DOMMouseScroll mousewheel":D}):r.scrollMode==="headerScroll"&&e(document).on({"DOMMouseScroll mousewheel":P});e(window).resize(function(){e(s).each(function(){e(this).css("height",e(window).outerHeight());e(this).outerHeight(e(window).outerHeight())})})}})}})(jQuery);